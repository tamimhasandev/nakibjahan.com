jQuery(function(_){"use strict";var r={get_geo_var:function(e){var e="#wcpbc-"+e,t=!1;return t=void 0!==_(e).data("value")&&_(e).data("value")&&-1<(t=_(e).data("value")).indexOf(",")?t.split(",").shift().trim():t},isset_geo_country:function(){return r.get_geo_var("mm-country-code")||r.get_geo_var("http-cf-ipcountry")||r.get_geo_var("geoip-country-code")||r.get_geo_var("http-x-country-code")},x_forwarded_for_issue:function(){return!r.isset_geo_country()&&!r.get_geo_var("http-x-real-ip")&&r.get_geo_var("http-x-forwarded-for")&&r.get_geo_var("http-x-forwarded-for")!==r.get_geo_var("remote-addr")&&r.get_geo_var("real-external-ip")===r.get_geo_var("remote-addr")},get_first_ip_no_empty:function(){var t=!1;return["http-x-real-ip","http-x-forwarded-for","remote-addr"].forEach(function(e){e=r.get_geo_var(e);!1===t&&!1!==e&&(t=e)}),t},remote_addr_test:function(){var e=r.get_geo_var("real-external-ip");_.post(wcpbc_system_report_params.ajax_url,{action:"wc_price_based_country_remote_addr_check",security:wcpbc_system_report_params.remote_addr_check_nonce,external_ip:e},function(e){"1"==e.result?r.get_geo_var("use-remote-addr")?r.append_result("ok"):r.append_result("fail",wcpbc_system_report_params.define_constant_alert):r.append_result("fail")})},first_ip_test:function(){var e=r.get_geo_var("real-external-ip"),t=r.get_first_ip_no_empty();_.post(wcpbc_system_report_params.ajax_url,{action:"wc_price_based_country_remote_addr_check",security:wcpbc_system_report_params.remote_addr_check_nonce,external_ip:e,remote_addr:t},function(e){"1"==e.result?r.append_result("ok"):r.append_result("fail",wcpbc_system_report_params.ip_no_match)})},append_result:function(e,t){var r="";switch(t=void 0===t?"":t,e){case"ok":r='<mark class="yes"><span class="dashicons dashicons-yes"></span></mark>';break;case"fail":r='<mark class="error"><span class="dashicons dashicons-warning"></span>'+t+"</mark>"}_("#wcpbc-geolocation-test td.wcpbc-geolocation-test-result").html(r)},geolocation_test:function(){r.isset_geo_country()||"yes"===r.get_geo_var("geoipdb-exists")?r.x_forwarded_for_issue()?r.get_geo_var("remote-addr")!==r.get_geo_var("real-external-ip")||r.get_geo_var("use-remote-addr")?r.remote_addr_test():r.append_result("fail",wcpbc_system_report_params.define_constant_alert):r.isset_geo_country()||r.get_first_ip_no_empty()===r.get_geo_var("real-external-ip")?r.append_result("ok"):r.first_ip_test():r.append_result("fail",wcpbc_system_report_params.geoipdb_required)},init:function(){_("#wcpbc-geolocation-debug").on("wc_price_based_country_real_external_ip_loaded",function(){r.geolocation_test()})}};r.init()});